= External Search Sources

This Rails Engine provides an interface, helpers, and fixture data for pulling search results from external sources via RSS feeds.

This plugin has only been tested on Rails 2.3 and higher. Prior versions will not work because of incomplete engine support or missing I18n support.


== Installation

=== Step 1

Install all dependancies.

* Plugin relies on ActiveScaffold for the admin interface.
* Plugin relies on Kete version of the Feedzirra gem

  sudo gem install kete-feedzirra

=== Step 2

Open a console, and in the root of you Rails application, install the plugin by running one of the following (depending on the method you use to import plugins):

* script/plugin install git://github.com/kete/external_search_sources.git
* piston import git://github.com/kete/external_search_sources.git vendor/plugins/external_search_sources
* git submodule add git://github.com/kete/external_search_sources.git vendor/plugins/external_search_sources
* Download the latest files ( http://github.com/kete/external_search_sources/tarball/master ) and extract to vendor/plugins/external_search_sources

=== Step 3

Install migrations and public images.

  rake external_search_sources:sync

=== Step 4

Update your database.

  rake db:migrate

=== Step 5

Where you want search sources displayed, add the following to the view file

  display_search_sources 'test'

Replace the string 'test' with a variable or other string you want search sources to return results of.

=== Step 6

Add some search sources. Go to /search_sources/list and add some data into the correct fields.

Alternatively, use some fixture data included with the plugin by running

  rake external_search_sources:import:kete_horowhenua_images


== Configuration

=== Styling

Nesting of divs and results is as follows. You'll need firebug or examine the source manually if you need more than this.

* div with id of search_sources
** h3 of box title
** for each search source
*** h4 of search source title
*** div with id of '[search_source_title_id]_links'
*** for each link result
**** div with id of '[search_source_title_id]_result_[result_object_id]', class from ExternalSearchSources[:default_link_classes]
*** div with id of '[search_source_title_id]_images', with class of 'images'
*** for each image result
**** div with id of '[search_source_title_id]_result_[result_object_id]', class from ExternalSearchSources[:image_link_classes]
*** div with id of '[search_source_title_id]_more_results', with class of 'default_link_classes'

=== Settings

ExternalSearchSources has methods for [] (accessor) and []= (writer). The settings available can be found in

  lib/external_search_sources.rb

To override some settings, create an initializer, copy the config lines from lib/external_search_sources.rb to the initializer, and change to suit.

If you don't add settings to the initializer, the plugin will fall back to what is uses by default.

=== Output

The display_search_sources helper method takes an options hash as a second parameter.

So far, the working options are:

* :target
** Pass in a symbol that matches an source targets (ExternalSearchSources[:source_targets]).
** Using the defaults, you can use either :homepage or :search.
** If no target is passed in, all search sources are displayed.

* :do_not_cache
** Overwrite caching on a per display basis. Set to true to disable caching for the output.

* :limit
** Overwrite the search sources default limit. Useful for cases where the number per page changes dynamically.


== Testing

The plugin comes with a test suite that can be run once the plugin is installed in an application.

Change into the plugins directory and run 'rake' to start them.

Note: The tests require Rails 2.2 or higher, and are currently tested on Rails 2.3 (so problems in older versions may arise - please see "Reporting an Issue" if they do)


== Reporting an Issue

If you have a problem, please report it on the external_search_sources plugin ticket tracker (on Ligthouseapp)

http://kete.lighthouseapp.com/projects/32521-external_search_sources/tickets

Be sure to include Rails version, plugin version, and when possible, a sample application that can reproduce the problem. Upload it to one of the various file hosting sites and link to it in the ticket. Don't include vendored rails or the external_search_sources plugin in the archive (if I know the versions, I'll add these myself).


== Contributing

If you've added something, why not share it. Fork the repository (http://github.com/kete/external_search_sources), make the changes and send a pull request to the maintainers.

Changes with tests, and full documentation are preferred.


= Credits

This plugin is currently maintained by Kieran Pilkington <kieran@katipo.co.nz>
